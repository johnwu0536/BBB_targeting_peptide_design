2025-11-06 05:07:18,175 - INFO - Starting BBB-penetrating peptide design pipeline
2025-11-06 05:07:18,175 - INFO - Target receptor: TFRC
2025-11-06 05:07:18,175 - INFO - Using device: cuda
2025-11-06 05:07:18,175 - INFO - Step 1: Training classifier
2025-11-06 05:07:18,175 - INFO - Running: python -m src.train_classifier --config config.yaml
2025-11-06 05:07:50,199 - INFO - Command succeeded: python -m src.train_classifier --config config.yaml
2025-11-06 05:07:50,199 - INFO - Output: [train_classifier] Using device: cuda
[train_classifier] Loading data...
[data_loader] Loaded 214 sequences (37 positive, 177 negative)
[data_loader] Created loaders - Train: 5 batches, Val: 1 batches, Test: 1 batches
[train_classifier] Creating model...
[train_classifier] Model parameters: 2,436,035
[train_classifier] Starting training...
Epoch   1 | Train Loss: 0.5680 | Val Loss: 0.4219 | Acc: 0.8438 | F1: 0.0000 | AUC: 0.6667 | Val samples: 32 (5+/27-)
[train_classifier] Saved best model to checkpoints/classifier_best.pth
Epoch   2 | Train Loss: 0.3721 | Val Loss: 0.4114 | Acc: 0.8125 | F1: 0.2500 | AUC: 0.7111 | Val samples: 32 (5+/27-)
[train_classifier] Saved best model to checkpoints/classifier_best.pth
Epoch   3 | Train Loss: 0.3056 | Val Loss: 0.5738 | Acc: 0.8125 | F1: 0.0000 | AUC: 0.7481 | Val samples: 32 (5+/27-)
Epoch   4 | Train Loss: 0.2167 | Val Loss: 0.5774 | Acc: 0.7812 | F1: 0.4615 | AUC: 0.7333 | Val samples: 32 (5+/27-)
Epoch   5 | Train Loss: 0.1714 | Val Loss: 0.7752 | Acc: 0.8750 | F1: 0.3333 | AUC: 0.7407 | Val samples: 32 (5+/27-)
Epoch   6 | Train Loss: 0.2019 | Val Loss: 0.6294 | Acc: 0.8125 | F1: 0.5000 | AUC: 0.7111 | Val samples: 32 (5+/27-)
Epoch   7 | Train Loss: 0.1405 | Val Loss: 0.8219 | Acc: 0.8438 | F1: 0.4444 | AUC: 0.7111 | Val samples: 32 (5+/27-)
Epoch   8 | Train Loss: 0.1044 | Val Loss: 0.7988 | Acc: 0.8125 | F1: 0.4000 | AUC: 0.6741 | Val samples: 32 (5+/27-)
Epoch   9 | Train Loss: 0.0671 | Val Loss: 0.8363 | Acc: 0.8438 | F1: 0.5455 | AUC: 0.6889 | Val samples: 32 (5+/27-)
Epoch  10 | Train Loss: 0.0554 | Val Loss: 0.9838 | Acc: 0.8125 | F1: 0.4000 | AUC: 0.7259 | Val samples: 32 (5+/27-)
Epoch  11 | Train Loss: 0.0251 | Val Loss: 1.1014 | Acc: 0.8750 | F1: 0.5000 | AUC: 0.7481 | Val samples: 32 (5+/27-)
Epoch  12 | Train Loss: 0.0066 | Val Loss: 1.2677 | Acc: 0.8438 | F1: 0.5455 | AUC: 0.7333 | Val samples: 32 (5+/27-)
[train_classifier] Early stopping at epoch 12

[train_classifier] Final evaluation on test set...
Test Results:
  Loss: 1.2942
  Accuracy: 0.8438
  F1 Score: 0.5455
  AUC: 0.7926
  Confusion Matrix:
    True Negatives: 24
    False Positives: 3
    False Negatives: 2
    True Positives: 3
[train_classifier] Training completed. Metrics saved to results/classifier_metrics.json

2025-11-06 05:07:50,199 - INFO - Step 2: Temperature calibration
2025-11-06 05:07:50,200 - INFO - Running: python -m src.calibrate_temperature --config config.yaml
2025-11-06 05:07:54,975 - ERROR - Command failed: python -m src.calibrate_temperature --config config.yaml
2025-11-06 05:07:54,976 - ERROR - Error output: 
2025-11-06 05:07:54,976 - ERROR - Temperature calibration failed
